




<link rel="stylesheet" href="https://unpkg.com/@ag-grid-community/core@27.0.1/dist/styles/ag-grid.css" />
<link rel="stylesheet" href="https://unpkg.com/@ag-grid-community/core@27.0.1/dist/styles/ag-theme-alpine.css" />
<link rel="stylesheet" href="https://unpkg.com/@ag-grid-community/core@27.0.1/dist/styles/ag-theme-alpine-dark.css" />
<link rel="stylesheet" href="https://unpkg.com/@ag-grid-community/core@27.0.1/dist/styles/ag-theme-balham-dark.css" />
<link rel="stylesheet" href="https://unpkg.com/@ag-grid-community/core@27.0.1/dist/styles/ag-theme-balham.css" />
<link rel="stylesheet" href="https://unpkg.com/@ag-grid-community/core@27.0.1/dist/styles/ag-theme-material.css" />

<div>

    <div style="display: flex; height: 53px">
        <mat-form-field class="example-full-width" appearance="fill">
            <mat-label>Choose a start date</mat-label>
            <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker" [(ngModel)]="start_date">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
        
        <mat-form-field class="example-full-width" appearance="fill" style="margin-left: 10px;">
            <mat-label>Choose a end date</mat-label>
            <input matInput [min]="minDate" [max]="maxDate" [matDatepicker]="pickerx" [(ngModel)]="end_date">
            <mat-datepicker-toggle matSuffix [for]="pickerx"></mat-datepicker-toggle>
            <mat-datepicker #pickerx></mat-datepicker>
        </mat-form-field>
        
        <button (click)="clickme()" class="clickme">Submit</button>
        <button *ngIf="!loading && isDateLoaded" (click)="exportExcel()" class="clickme">Download</button>
    </div>

    <br> <br>

    <div *ngIf="loading" style="display: flex;justify-content: center;align-items: center;width: 102%;"> 
        <div class="dot-floating" >
        </div>
    </div>

    <div *ngIf="isDateLoaded" style="height: 600px;padding: 10px;box-shadow:0 0 2px #ace5ee;">
        <ag-grid-angular id="ag-grid"
            style="width: 100%; height:100% ;overflow-x: scroll;border-radius: 5px;"
            class="ag-theme-material"
            [paginationAutoPageSize]="true"
            [pagination]="true"
            [animateRows]= "true"
            [suppressHorizontalScroll]="false"
            [frameworkComponents] = "frameworkComponents"
            [rowData]="rowData"
            [columnDefs]="columnDefs">
        </ag-grid-angular>
    </div>
</div>